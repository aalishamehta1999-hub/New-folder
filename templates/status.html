<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Status</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center p-4">
  <div class="bg-white shadow-xl rounded-2xl w-full max-w-4xl p-6">
    <h1 class="text-3xl font-bold text-green-600 mb-4 text-center">Job Status</h1>

    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 h-96 overflow-y-auto">
      <pre id="logs" class="text-gray-800 whitespace-pre-wrap"></pre>
    </div>

    <div class="mt-4 flex justify-between items-center">
      <span class="text-gray-600 font-medium">Status:</span>
      <span id="status" class="font-bold text-green-600"></span>
      <span class="text-gray-600 font-medium">Progress:</span>
      <span id="progress-text" class="font-bold text-green-600"></span>
    </div>

    <div class="mt-2 w-full bg-gray-200 rounded-full h-4">
      <div id="progress-bar" class="bg-green-500 h-4 rounded-full w-0"></div>
    </div>
  </div>

<script>
async function refresh() {
  const res = await fetch('/status/{{ job_id }}/logs');
  const data = await res.json();
  document.getElementById('status').innerText = data.status || '';
  const logs = (data.logs || []);
  document.getElementById('logs').innerText = logs.join('\n');

  const progress = data.progress || 0;
  document.getElementById('progress-bar').style.width = progress + '%';
  document.getElementById('progress-text').innerText = progress + '%';
}
setInterval(refresh, 2000);
window.onload = refresh;
</script>
</body>
</html>
